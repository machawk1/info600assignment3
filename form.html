<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Record Management</title>
    <link rel="stylesheet" href="css/main.css" />
    <script src="js/main.js"></script>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<body>

<h1>Student Record Management</h1>

<form id="inputs" method="post">
<div>
  <label for="fullName">Full Name</label>
  <input type="text" name="fullName" id="fullName" />
</div>
<div>
  <label for="major">Major</label>
  <input type="text" name="major" id="major" />
</div>

<div>
  <label for="startYear">Start Year</label>
  <input type="text" name="startYear" id="startYear" />
</div>

<div id="buttonParent">
<input type="button" value="Add Record" id="addRec" onclick="handleSubmit()" />
</div>
</form>

<br />

<h1>Entered Records:</h1>

<ul id="enteredRecords">
</ul>

<div>
  <input type="button" value="Load Data!" id="loadData" />
  <div id="results"> </div>
</div>
</body>
</html>

<script>

$(document).ready(function(){
  $("#loadData").click(function(){
    $.get("http://127.0.0.1:8081/users", function(data, status){
      //alert("Data: " + data + "\nStatus: " + status);
      var dataObject =JSON.stringify(data);
      console.log(data.records)
      $.each(data, function() {
        $.each(this, function(k, v) {
          console.log(this.fullName)
          var date = new Date()
          const hours = date.getHours().toString().padStart(2, '0')
          const minutes = date.getMinutes().toString().padStart(2, '0')
          const time = hours + ':' + minutes

          $("#results").append("<li>" + time + " - " + this.fullName +", " + this.major + ", "+ this.startYear +"</li>");
        });
      });
      
    });
  });
});

function handleSubmit(){
    console.log("here")
    name = $("#fullName").val();
    major = $("#major").val();
    startYear = $("#startYear").val();

    alert(name + major + startYear  );
    $.ajax({
      type: "POST",
      url: "http://127.0.0.1:8081/user/",
      contentType: "application/json",
      data:  {fullName:name, major:major, startYear:startYear},
    });
  }


</script>